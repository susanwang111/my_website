---
title: "Project 5 GDP and Components"
subtitle: "GDP components change over time and among countries"
image: pic06.jpg
output:
  html_document:
    theme: flatly
    highlight: zenburn
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>At the risk of oversimplifying things, the main components of gross domestic product, GDP are personal consumption (C), business investment (I), government spending (G) and net exports (exports - imports).</p>
<p>The GDP data we will look at is from the <a href="https://unstats.un.org/unsd/snaama/Downloads">United Nations’ National Accounts Main Aggregates Database</a>, which contains estimates of total GDP and its components for all countries from 1970 to today. We will look at how GDP and its components have changed over time, and compare different countries and how much each component contributes to that country’s GDP. The file we work with is <a href="http://unstats.un.org/unsd/amaapi/api/file/6">GDP and its breakdown at constant 2010 prices in US Dollars</a>.</p>
<pre class="r"><code>UN_GDP_data  &lt;-  read_excel(here::here(&quot;content&quot;,&quot;projects&quot;,&quot;project5&quot;,&quot;Download-GDPconstant-USD-countries.xlsx&quot;), 
                sheet=&quot;Download-GDPconstant-USD-countr&quot;, 
                skip=2) </code></pre>
<p>The first thing we need to do is to tidy the data, as it is in wide format and we must make it into long, tidy format. We express all figures in billions (divide values by <code>1e9</code>, or <span class="math inline">\(10^9\)</span>), and we want to rename the indicators into something shorter.</p>
<pre class="r"><code>library(dplyr)
library(R.utils)
library(readr)
library(ggtext)
library(scales)
library(lubridate)

tidy_GDP_data &lt;- UN_GDP_data %&gt;% 
  subset(select = -c(CountryID)) %&gt;% 
  pivot_longer(cols = 3:52,
               names_to = &quot;year&quot;,
               values_to = &quot;value&quot;) %&gt;% 
  mutate(value = value/1e9)

glimpse(tidy_GDP_data)</code></pre>
<pre><code>## Rows: 184,350
## Columns: 4
## $ Country       &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanista…
## $ IndicatorName &lt;chr&gt; &quot;Final consumption expenditure&quot;, &quot;Final consumption expe…
## $ year          &lt;chr&gt; &quot;1970&quot;, &quot;1971&quot;, &quot;1972&quot;, &quot;1973&quot;, &quot;1974&quot;, &quot;1975&quot;, &quot;1976&quot;, …
## $ value         &lt;dbl&gt; 3.07, 2.96, 2.89, 3.10, 3.33, 3.51, 3.59, 3.83, 3.99, 3.…</code></pre>
<pre class="r"><code># Let us compare GDP components for these 3 countries
country_list &lt;- c(&quot;United States&quot;,&quot;India&quot;, &quot;Germany&quot;)

tidy_GDP_data$IndicatorName[tidy_GDP_data$IndicatorName == &quot;Exports of goods and services&quot;] &lt;- &quot;Exports&quot;
tidy_GDP_data$IndicatorName[tidy_GDP_data$IndicatorName == &quot;General government final consumption expenditure&quot;] &lt;- &quot;Government expenditure&quot;
tidy_GDP_data$IndicatorName[tidy_GDP_data$IndicatorName == &quot;Household consumption expenditure (including Non-profit institutions serving households)&quot;] &lt;- &quot;Household expenditure&quot;
tidy_GDP_data$IndicatorName[tidy_GDP_data$IndicatorName == &quot;Imports of goods and services&quot;] &lt;- &quot;Imports&quot;
tidy_GDP_data$IndicatorName[tidy_GDP_data$IndicatorName == &quot;Gross Domestic Product (GDP)&quot;] &lt;- &quot;GDP&quot;

country_list_GDP_all &lt;- subset(tidy_GDP_data, Country == &quot;United States&quot;|
                                 Country == &quot;India&quot;|
                                 Country == &quot;Germany&quot;)
country_list_GDP_all</code></pre>
<pre><code>## # A tibble: 2,550 × 4
##    Country IndicatorName                 year  value
##    &lt;chr&gt;   &lt;chr&gt;                         &lt;chr&gt; &lt;dbl&gt;
##  1 Germany Final consumption expenditure 1970  1031.
##  2 Germany Final consumption expenditure 1971  1090.
##  3 Germany Final consumption expenditure 1972  1147.
##  4 Germany Final consumption expenditure 1973  1189.
##  5 Germany Final consumption expenditure 1974  1204.
##  6 Germany Final consumption expenditure 1975  1252.
##  7 Germany Final consumption expenditure 1976  1298.
##  8 Germany Final consumption expenditure 1977  1346.
##  9 Germany Final consumption expenditure 1978  1396.
## 10 Germany Final consumption expenditure 1979  1445.
## # … with 2,540 more rows</code></pre>
<pre class="r"><code>country_list_GDP_components&lt;-subset(country_list_GDP_all, IndicatorName == &quot;Gross capital formation&quot; |
                             IndicatorName == &quot;Exports&quot; |
                             IndicatorName == &quot;Government expenditure&quot; |
                             IndicatorName == &quot;Household expenditure&quot; |
                             IndicatorName == &quot;Imports&quot;) %&gt;% 
                             mutate(IndicatorName = factor(IndicatorName, levels = c(&quot;Gross capital formation&quot;, &quot;Exports&quot;, &quot;Government expenditure&quot;, &quot;Household expenditure&quot;, &quot;Imports&quot;)))
country_list_GDP_components</code></pre>
<pre><code>## # A tibble: 750 × 4
##    Country IndicatorName         year  value
##    &lt;chr&gt;   &lt;fct&gt;                 &lt;chr&gt; &lt;dbl&gt;
##  1 Germany Household expenditure 1970   778.
##  2 Germany Household expenditure 1971   820.
##  3 Germany Household expenditure 1972   865.
##  4 Germany Household expenditure 1973   889.
##  5 Germany Household expenditure 1974   888.
##  6 Germany Household expenditure 1975   921.
##  7 Germany Household expenditure 1976   960.
##  8 Germany Household expenditure 1977  1001.
##  9 Germany Household expenditure 1978  1037.
## 10 Germany Household expenditure 1979  1071.
## # … with 740 more rows</code></pre>
<pre class="r"><code># Create a subset to include only the three countries

country_list_GDP &lt;- subset(country_list_GDP_components, Country %in% c(country_list)) </code></pre>
<p>First, we produce this plot:</p>
<pre class="r"><code>country_list_GDP_plot&lt;- ggplot(country_list_GDP, aes(x = year, y = value, group=IndicatorName, colour=IndicatorName)) +
                        geom_path(size = 0.8) +
                        facet_wrap(~factor(country_list_GDP$Country, levels = unique(country_list_GDP$Country)))+
                        theme_bw()+
                        scale_x_discrete(breaks = c(1970, 1980, 1990, 2000, 2010)) +
                        labs(title = &quot;GDP components over time&quot;,
                             subtitle = &quot;In constant 2010 USD&quot;,
                             x = &quot; &quot;, y= &quot;Billion US$&quot;,
                             color=&#39;Components of GDP&#39;) +
                        theme(#plot.title = element_text(size=20, face = &quot;bold&quot;), 
                              #plot.subtitle = element_markdown(size= 15), 
                              legend.title = element_text(size=10),
                              legend.text = element_text(size=9),
                              strip.text = element_text(size=10),
                              axis.title.y = element_text(size = 12),
                              axis.text.y = element_text(size = 9),
                              axis.text.x = element_text(size = 9)) +
                           NULL

country_list_GDP_plot</code></pre>
<p><img src="/projects/project5/gdp_files/figure-html/country_list_GDP_plot-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Secondly, recall that GDP is the sum of Household Expenditure (Consumption <em>C</em>), Gross Capital Formation (business investment <em>I</em>), Government Expenditure (G) and Net Exports (exports - imports). Even though there is an indicator <code>Gross Domestic Product (GDP)</code> in our dataframe, we calculate it given its components discussed above.</p>
<pre class="r"><code>GDP_breakdown &lt;- country_list_GDP %&gt;% 
  pivot_wider(names_from = IndicatorName, values_from = value) %&gt;% 
  mutate(`Net exports` = Exports - Imports,
         GDP = `Gross capital formation`+`Household expenditure`+`Government expenditure`+`Net exports`,
         `Government Expenditure` = `Government expenditure`/GDP,
         `Household Expenditure` = `Household expenditure`/GDP,
         `Gross Capital Formation` = `Gross capital formation`/GDP,
         `Net Exports` = `Net exports`/GDP) %&gt;% 
  select(Country, year,GDP,`Government Expenditure`,`Household Expenditure`,`Gross Capital Formation`,`Net Exports`) </code></pre>
<div id="the-difference-between-what-we-calculated-as-gdp-and-the-gdp-figure-included-in-the-dataframe" class="section level2">
<h2>The % difference between what we calculated as GDP and the GDP figure included in the dataframe</h2>
<p>For Germany and the US, there is on average a positive % difference, while for India it is negative. This may be caused by the strength of local currencies against the USD. An important factor that the UN used to calculate the composition of GDP is exchange rate. Furthermore, using a unique exchange rate for 1 year may not be entirely justified and may cause differences between GDP figure and calculated GDP.</p>
<pre class="r"><code>GDP_compare &lt;- subset(country_list_GDP_all, IndicatorName == &quot;GDP&quot;) %&gt;% 
  pivot_wider(names_from = IndicatorName, values_from = value) %&gt;% 
  add_column(calculated_GDP = GDP_breakdown$GDP) %&gt;% 
  mutate(difference = ((calculated_GDP-GDP)/calculated_GDP),
         difference = scales::percent(difference)) 

GDP_compare</code></pre>
<pre><code>## # A tibble: 150 × 5
##    Country year    GDP calculated_GDP difference
##    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;     
##  1 Germany 1970  1398.          1437. 2.7135882%
##  2 Germany 1971  1442.          1489. 3.1703301%
##  3 Germany 1972  1504.          1553. 3.1666321%
##  4 Germany 1973  1576.          1617. 2.5456114%
##  5 Germany 1974  1590.          1611. 1.3296327%
##  6 Germany 1975  1576.          1615. 2.3815824%
##  7 Germany 1976  1654.          1694. 2.3506316%
##  8 Germany 1977  1710.          1749. 2.2655946%
##  9 Germany 1978  1761.          1807. 2.5495756%
## 10 Germany 1979  1834.          1891. 3.0133938%
## # … with 140 more rows</code></pre>
<p>Then we create a breakdown plot.</p>
<pre class="r"><code>GDP_breakdown_data &lt;- GDP_breakdown %&gt;% 
  subset(select = -c(GDP)) %&gt;% 
pivot_longer(cols = 3:6,
               names_to = &quot;component&quot;,
               values_to = &quot;proportion&quot;) 

GDP_breakdown_plot &lt;-
  ggplot(GDP_breakdown_data, aes(x = year, y = proportion, group=component, colour=component)) +
  geom_line(size = 0.8) +
  facet_wrap(~factor(GDP_breakdown_data$Country, levels = unique(GDP_breakdown_data$Country)))+
  theme_bw()+
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.1))+
  scale_x_discrete(breaks = c(1970, 1980, 1990, 2000, 2010)) +
  labs(title = &quot;GDP and its breakdown at constant 2010 prices in US Dollars&quot;,
       x = &quot; &quot;, 
       y= &quot;Proportion&quot;,
       color=&#39;Components of GDP&#39;,
       caption= &quot;Source: United Nations, https://unstats.un.org/unsd/snaama/Downloads&quot;) +
  theme(#plot.title = element_text(size=12, face = &quot;bold&quot;), 
        legend.title = element_blank(),
        legend.text = element_text(size=8),
        strip.text = element_text(size=10),
        axis.title.y = element_text(size = 12),
        axis.text.y = element_text(size = 9),
        axis.text.x = element_text(size = 9)) +
     NULL

GDP_breakdown_plot</code></pre>
<p><img src="/projects/project5/gdp_files/figure-html/GDP_breakdown_plot-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>In the case of Germany, from 1970 onwards, there is a clear positive trend in net exports and negative trend in household consumption. Positive net exports is a clear sign that Germany is relying a big proportion of its economy on exports, and it makes sense given the industrialization produced in the last 20 years in that country. On the other hand, household consumption has declined slightly, making Germany a less dependent country of consumer momentum.</p>
<p>In the case of India, there is a clear positive trend in gross capital formation that is coherent with the last 2 decades of constant growth in India’s production capabilities. As a consequence, India is less dependent on internal consumer momentum and it is following China’s steps in becoming a global industrial producer.</p>
<p>Finally, in the US consumption has become more relevant as years passed, which makes the US economy more dependent on consumer’s confidence. On the other hand, Government Expenditure contribution to GDP has been declining and that may be the reason why the US is now aiming to increase its Government Expenditure in national infrastructure in order to close the infra gap not pursued by previous governments and that is reflected in GDP’s composition.</p>
<p>Then we change <code>country_list &lt;- c("United States","India", "Germany")</code> to include our own country selection.</p>
<pre class="r"><code># Create a new list of the three countries we selected
country_list_new &lt;- c(&quot;China&quot;,&quot;Peru&quot;, &quot;Spain&quot;)

country_list_GDP_all_new &lt;- subset(tidy_GDP_data, Country == &quot;China&quot;|
                                 Country == &quot;Peru&quot;|
                                 Country == &quot;Spain&quot;)

country_list_GDP_components&lt;-subset(country_list_GDP_all_new, IndicatorName == &quot;Gross capital formation&quot; |
                             IndicatorName == &quot;Exports&quot; |
                             IndicatorName == &quot;Government expenditure&quot; |
                             IndicatorName == &quot;Household expenditure&quot; |
                             IndicatorName == &quot;Imports&quot;) %&gt;% 
                             mutate(IndicatorName = factor(IndicatorName, levels = c(&quot;Gross capital formation&quot;, &quot;Exports&quot;, &quot;Government expenditure&quot;, &quot;Household expenditure&quot;, &quot;Imports&quot;)))
country_list_GDP_components</code></pre>
<pre><code>## # A tibble: 750 × 4
##    Country IndicatorName         year  value
##    &lt;chr&gt;   &lt;fct&gt;                 &lt;chr&gt; &lt;dbl&gt;
##  1 China   Household expenditure 1970   138.
##  2 China   Household expenditure 1971   144.
##  3 China   Household expenditure 1972   151.
##  4 China   Household expenditure 1973   162.
##  5 China   Household expenditure 1974   165.
##  6 China   Household expenditure 1975   172.
##  7 China   Household expenditure 1976   178.
##  8 China   Household expenditure 1977   183.
##  9 China   Household expenditure 1978   193.
## 10 China   Household expenditure 1979   202.
## # … with 740 more rows</code></pre>
<pre class="r"><code># Subset of data of the three countries 
country_list_GDP_new &lt;- subset(country_list_GDP_components, Country %in% c(country_list_new))
country_list_GDP_new</code></pre>
<pre><code>## # A tibble: 750 × 4
##    Country IndicatorName         year  value
##    &lt;chr&gt;   &lt;fct&gt;                 &lt;chr&gt; &lt;dbl&gt;
##  1 China   Household expenditure 1970   138.
##  2 China   Household expenditure 1971   144.
##  3 China   Household expenditure 1972   151.
##  4 China   Household expenditure 1973   162.
##  5 China   Household expenditure 1974   165.
##  6 China   Household expenditure 1975   172.
##  7 China   Household expenditure 1976   178.
##  8 China   Household expenditure 1977   183.
##  9 China   Household expenditure 1978   193.
## 10 China   Household expenditure 1979   202.
## # … with 740 more rows</code></pre>
<pre class="r"><code># Plot the GDP components over time for the three countries
country_list_GDP_plot_new &lt;- 
  ggplot(country_list_GDP_new, aes(x = year, y = value, group=IndicatorName, colour=IndicatorName)) +
  geom_path(size = 0.8) +
  facet_wrap(~factor(Country))+
  theme_bw()+
  scale_x_discrete(breaks = c(1970, 1980, 1990, 2000, 2010)) +
  labs(title = &quot;GDP components over time&quot;,
       subtitle = &quot;In constant 2010 USD&quot;,
       x = &quot; &quot;, y= &quot;Billion US$&quot;,
       color=&#39;Components of GDP&#39;) +
  theme(#plot.title = element_text(size=20, face = &quot;bold&quot;), 
                              #plot.subtitle = element_markdown(size= 15), 
                              legend.title = element_text(size=10),
                              legend.text = element_text(size=8.5),
                              strip.text = element_text(size=10),
                              axis.title.y = element_text(size = 12),
                              axis.text.y = element_text(size = 9),
                              axis.text.x = element_text(size = 9)) +
                           NULL

country_list_GDP_plot_new</code></pre>
<p><img src="/projects/project5/gdp_files/figure-html/country_list_GDP_plot_new-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Evolution of GDP components graph for China shows the exponential growth that the Chinese economy has experienced in the last 40 years. All components of China’s GDP experienced growth and we can appreciate that gross capital formation contributes the most to the economy, a fact that makes sense as China is the most relevant industrial producer for the entire world.</p>
<p>Regarding Peru GDP’s components, most components grew slightly as a result of the different economic crisis that Peru suffered from 1980 to 2000. From 2000 onwards, Peru’s economy grew but not as much as China’s economy.</p>
<p>Finally, Spain’s economy experienced growth especially in its household consumption component. Nevertheless, the rest of the components have been relatively flat, a situation that can be caused by slow growth in the Spanish economy in the last 2 decades.</p>
<pre class="r"><code># Calculate GDP and % of each component
GDP_breakdown_new &lt;- country_list_GDP_new %&gt;% 
  pivot_wider(names_from = IndicatorName, values_from = value) %&gt;% 
  mutate(`Net exports` = Exports - Imports,
         GDP = `Gross capital formation`+`Household expenditure`+`Government expenditure`+`Net exports`,
         `Government Expenditure` = `Government expenditure`/GDP,
         `Household Expenditure` = `Household expenditure`/GDP,
         `Gross Capital Formation` = `Gross capital formation`/GDP,
         `Net Exports` = `Net exports`/GDP) %&gt;% 
  select(Country, year,GDP,`Government Expenditure`,`Household Expenditure`,`Gross Capital Formation`,`Net Exports`) </code></pre>
<pre class="r"><code># Plot GDP breakdown of the three countries (%)
GDP_breakdown_data_new &lt;- GDP_breakdown_new %&gt;% 
  subset(select = -c(GDP)) %&gt;% 
pivot_longer(cols = 3:6,
               names_to = &quot;component&quot;,
               values_to = &quot;proportion&quot;) 

GDP_breakdown_plot_new &lt;-
  ggplot(GDP_breakdown_data_new, aes(x = year, y = proportion, group=component, colour=component)) +
  geom_line(size = 0.8) +
  facet_wrap(~factor(Country))+
  theme_bw()+
  scale_y_continuous(labels = scales::percent)+
  scale_x_discrete(breaks = c(1970, 1980, 1990, 2000, 2010)) +
  labs(title = &quot;GDP and its breakdown at constant 2010 prices in US Dollars&quot;,
       x = &quot; &quot;, y= &quot;Proportion&quot;,
       color=&#39;Components of GDP&#39;) +
  theme(#plot.title = element_text(size=12, face = &quot;bold&quot;), 
        legend.title = element_blank(),
        legend.text = element_text(size=8),
        strip.text = element_text(size=10),
        axis.title.y = element_text(size = 12),
        axis.text.y = element_text(size = 9),
        axis.text.x = element_text(size = 9)) +
     NULL

GDP_breakdown_plot_new</code></pre>
<p><img src="/projects/project5/gdp_files/figure-html/GDP_breakdown_plot_new-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>The Chinese economy has become less dependent on household consumption, becoming an economy in constant growth supported by investment in increasing production capabilities.</p>
<p>The Peruvian economy is still dependent on internal demand. We can appreciate that there has been an increasing importance of the gross capital formation component, which is coherent with the economic evolution of an underdeveloped economy.</p>
<p>Finally, Spain has experienced a decline in the relevance of gross capital formation. Lower investments can be explained by recent economic downturns in Spain and the lower confidence of international investors in Spanish economy.</p>
</div>
